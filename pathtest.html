<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Page Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <style></style>
  <body></body>
  <script>
    // PATHFINDING
    const roads = {
      barovia: [
        [0, 1],
        [0, 2],
        [0, 3],
        [0, 4],
        ['gypsy.start', 'strahd.start']
      ],
      gypsy: [['barovia.end', 'strahd.start'], [0, 5], [0, 6], [0, 7], [0, 8]],
      strahd: [
        ['gypsy.start', 'borovia.end'],
        [1, 4],
        [2, 4],
        [3, 4],
        [4, 4],
        [5, 4]
      ]
    };

    function findStartingRoad(start) {
      let matchRoadName = null;
      const match = {
        closest: 9999,
        road: null,
        direction: null
      };

      Object.keys(roads).forEach(key => {
        const road = roads[key];
        let firstPoint = road[0];

        if (typeof road[0][0] === 'string') {
          firstPoint = road[1];
        }

        const distance =
          Math.abs(start[0] - firstPoint[0]) +
          Math.abs(start[1] - firstPoint[1]);
        if (distance < match.closest) {
          match.closest = distance;
          match.road = key;
          match.direction = 'start';
        }
      });

      //   reverse
      Object.keys(roads).forEach(key => {
        const road = roads[key];
        const roadLength = road.length - 1;
        let firstPoint = road[roadLength];

        if (typeof road[roadLength][0] === 'string') {
          firstPoint = road[roadLength - 1];
        }

        const distance =
          Math.abs(start[0] - firstPoint[0]) +
          Math.abs(start[1] - firstPoint[1]);
        if (distance < match.closest) {
          match.closest = distance;
          match.road = key;
          match.direction = 'end';
        }
      });

      return match;
    }

    function findPath(start, end) {
      const match = findStartingRoad(start);
      let startingRoad = roads[match.road];
      if (roads.direction === 'end') startingRoad = startingRoad.reverse();

      const finalPath = [];

      startingRoad.forEach(point => {
        if (typeof point[0] === 'string') {
          findNewPath(point, end, startingRoad);
        } else {
          finalPath.push(point);
        }
      });
    }

    // function findNewPath(point, end, startingRoad) {
    //     point.forEach(name => {
    //         const newRoad = roads[name]
    //         if (newRoad[newRoad.length - 1])
    //     })
    // }

    findPath([5, 4], [0, 1]);

    // Object.keys(roads).forEach(key => {
    //   roads[key].points.forEach(point => {
    //     // const test = createElement('<div>test</div>');
    //     const div = document.createElement('div');
    //     div.style =
    //       'position:absolute;background:red;top:0;left:10px;height:20px;width:20px;';
    //     document.body.append(div);
    //   });
    // });
  </script>
</html>
